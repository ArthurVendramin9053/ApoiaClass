<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cadastro - Apoia Class</title>
  <link rel="stylesheet" href="stylecadastro.css">
</head>
<body>
  <header>
    <nav>
      <div class="logo">
        <a href="index.html" style="font-weight: bold; font-size: 1.2rem; color: #fff;">Apoia Class</a>
      </div>
      <div class="menu">
        <a href="index.html">Início</a>
        <a href="escolas.html">Escolas</a>
        <a href="adicionar-necessidades.html">Necessidades</a>
        <a href="login.html">Login</a>
        <a href="cadastro.html">Cadastro</a>
      </div>
    </nav>
  </header>

  <main>
    <form id="cadastroForm" novalidate>
      <h1>Cadastro de Escola</h1>

      <label for="nome">Nome da Escola</label>
      <input type="text" id="nome" name="nome" required />

      <label for="endereco">Endereço (Rua, Bairro ou Cidade)</label>
      <input type="text" id="endereco" name="endereco" required />

      <label for="cidade">Cidade</label>
      <input type="text" id="cidade" name="cidade" required />

      <label for="estado">Estado (UF)</label>
      <input type="text" id="estado" name="estado" maxlength="2" required />

      <label for="email">E-mail para Contato</label>
      <input type="email" id="email" name="email" autocomplete="email" required />

      <label for="telefone">Telefone</label>
      <input type="tel" id="telefone" name="telefone" autocomplete="tel" />

      <label for="senha">Criação de Senha</label>
      <input type="password" id="senha" name="senha" autocomplete="new-password" required />

      <label for="confirma-senha">Confirmação de Senha</label>
      <input type="password" id="confirma-senha" name="confirma-senha" autocomplete="new-password" required />

      <button type="submit">Cadastrar</button>

      <div class="links">
        <a href="login.html">Já tenho login</a> | 
        <a href="index.html">Voltar à Página Inicial</a>
      </div>
    </form>
  </main>

  <script>
    document.getElementById("cadastroForm").addEventListener("submit", function (e) {
      e.preventDefault();

      const nome = document.getElementById("nome").value;
      const endereco = document.getElementById("endereco").value;
      const cidade = document.getElementById("cidade").value;
      const estado = document.getElementById("estado").value;
      const email = document.getElementById("email").value;
      const telefone = document.getElementById("telefone").value;
      const senha = document.getElementById("senha").value;
      const confirmaSenha = document.getElementById("confirma-senha").value;

      if (senha !== confirmaSenha) {
        alert("As senhas não coincidem.");
        return;
      }

      const data = {
        email: email,
        username: nome,
        password: senha,
        name: nome,
        address_line: endereco,
        neighborhood: "",
        city: cidade,
        state: estado,
        contact_email: email,
        contact_phone: telefone
      };

      fetch("/cadastro", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      })
      .then(res => res.json())
      .then(response => {
        alert(response.message || response.error);
        if (response.message) {
          window.location.href = "login.html";
        }
      })
      .catch(err => {
        console.error("Erro ao cadastrar:", err);
        alert("Erro ao cadastrar.");
      });
    });
  </script>
</body>
</html>
